<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://fonts.googleapis.com/css?family=Tajawal&display=swap" rel="stylesheet"> 
        <style>
            html {
                font-size: 62.5%;
            }
            body {
                margin: 0;
            }
            body * {
                box-sizing: border-box;
            }
            .container {
                width: 100%;
                height: 100%;
                font-family: 'Tajawal', serif;
                background-color: darkslategray;
                background-size: cover;
                background-position: center;
            }
            .blockquote {
                position: absolute;
                bottom: 10%;
                right: 10%;
                width: 80%;
                max-width: 900px;
                padding: 70px;
                border-radius: 60px;
                background-color: rgba(255, 255, 255, 0.85);
                
            }
            .quote {
                color: #333;
                text-align: justify;
            }
            .attribution {
                margin-top: 30px;
                margin-bottom: -40px;
                color: rgba(0, 0, 0, 0.5);
                text-align: right;
            }
            .name {
                font-size: 2.2rem;
            }
            .source {
                font-size: 3rem;
                font-style: italic;
            }

            @media screen and (max-width: 812px), (max-height: 812px)  {
                .blockquote {
                    padding: 30px;
                    border-radius: 20px;
                }
                .attribution {
                    margin-bottom: -10px;
                }
                .name {
                    font-size: 1.4rem;
                }
                .source {
                    font-size: 1.8rem;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="blockquote">
                <div class="quote" style="font-size: 2.3rem; line-height: 4.4rem">In friendship...we think we have chosen our peers. In reality a few years' difference in the dates of our births, a few more miles between certain houses, the choice of one university instead of another...the accident of a topic being raised or not raised at a first meeting--any of these chances might have kept us apart. But, for a Christian, there are, strictly speaking no chances. A secret master of ceremonies has been at work. Christ, who said to the disciples, "Ye have not chosen me, but I have chosen you," can truly say to every group of Christian friends, "Ye have not chosen one another but I have chosen you for one another." The friendship is not a reward for our discriminating and good taste in finding one another out. It is the instrument by which God reveals to each of us the beauties of others.</div>
                <div class="attribution">
                    <span class="name">C.S. Lewis, </span>
                    <span class="source">Till We Have Faces</span>
                </div>
            </div>
        </div>

        <script>
            var BLOCKQUOTE_HEIGHT_PERCENTAGE = 0.8; //Blockquote el is 80% of page height
            var MILLISECONDS_PER_DAY = 24 * 60 * 60 * 1000;
            var NUM_PICTURES = 10;
            var _resizeThrottle;
            var QUOTES = [
                { quote: "To love at all is to be vulnerable. Love anything and your heart will be wrung and possibly broken. If you want to make sure of keeping it intact you must give it to no one, not even an animal. Wrap it carefully round with hobbies and little luxuries; avoid all entanglements. Lock it up safe in the casket or coffin of your selfishness. But in that casket, safe, dark, motionless, airless, it will change. It will not be broken; it will become unbreakable, impenetrable, irredeemable. To love is to be vulnerable.", source: "The Four Loves" },
                { quote: "Friendship is unnecessary, like philosophy, like art.... It has no survival value; rather it is one of those things which give value to survival.", source: "The Four Loves" },
                { quote: "Imagine yourself as a living house. God comes in to rebuild that house. At first, perhaps, you can understand what He is doing. He is getting the drains right and stopping the leaks in the roof and so on; you knew that those jobs needed doing and so you are not surprised. But presently He starts knocking the house about in a way that hurts abominably and does not seem to make any sense. What on earth is He up to? The explanation is that He is building quite a different house from the one you thought of - throwing out a new wing here, putting on an extra floor there, running up towers, making courtyards. You thought you were being made into a decent little cottage: but He is building a palace. He intends to come and live in it Himself.", source: "Mere Christianity" }
            ];

            //Init
            window.addEventListener("hashchange", hashChange);
            window.addEventListener("resize", function(event) {
                if (_resizeThrottle) {
                    return;
                }
                _resizeThrottle = window.setTimeout(function() {
                    _resizeThrottle = null;
                    windowResize();
                }, 100);
            });
            hashChange();
            windowResize();

            //Methods
            function hashChange(event) {
                params = getUrlParams();

                if (params.date) {
                    var d = new Date();
                    var daysElapsed = daysBetween(params.date, "2020-2-29"); //Days since the site went live

                    var containerEl = document.querySelector(".container");
                    containerEl.style.backgroundImage = "url(images/" + ((daysElapsed % NUM_PICTURES) + 1) + ".jpg)";

                    var quoteEl = document.querySelector(".quote");
                    quoteEl.textContent = QUOTES[daysElapsed % QUOTES.length].quote;

                    var sourceEl = document.querySelector(".source");
                    sourceEl.textContent = QUOTES[daysElapsed % QUOTES.length].source;
                } else {
                    var newParams = getUrlParams();
                    var d = new Date();
                    newParams.date = d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate();
                    setUrlParams(newParams);
                }
            }

            function getUrlParams() {
                var params = {};
                var hash = window.location.hash;
                if (!hash) {
                    return params;
                }
                var split = hash.substring(1).split("&");
                for (var i = 0; i < split.length; i++) {
                    var entrySplit = split[i].split("=");
                    params[decodeURIComponent(entrySplit[0])] = decodeURIComponent(entrySplit[1]);
                }
                return params;
            }

            function setUrlParams(params) {
                var hash = "";
                for (var key in params) {
                    if (params.hasOwnProperty(key)) {
                        if (hash.length > 1) {
                            hash += "&";
                        }
                        hash += encodeURIComponent(key) + "=" + encodeURIComponent(params[key]);
                    }
                }
                window.location.hash = hash;
            }

            function windowResize() {
                var windowHeight = window.innerHeight;
                var blockquoteEl = document.querySelector(".blockquote");
                var quoteEl = document.querySelector(".quote");
                var shrinking = false;
                var growing = false;
                while (!(shrinking && growing)) { //Once we've shrunk and grown, we must have hit close to equalibrium
                    var fontSize = parseFloat(quoteEl.style.fontSize);
                    var lineHeight = parseFloat(quoteEl.style.lineHeight);

                    if (blockquoteEl.offsetHeight > windowHeight * BLOCKQUOTE_HEIGHT_PERCENTAGE) {
                        shrinking = true;
                        if (fontSize / lineHeight > 0.6) { //Decrease font size
                            quoteEl.style.fontSize = (fontSize - 0.1) + "rem";
                        } else { //Decrease line height
                            quoteEl.style.lineHeight = (lineHeight - 0.1) + "rem";
                        }
                    } else if (fontSize < 2.3 || lineHeight < 4.4) {
                        growing = true;
                        if (fontSize / lineHeight < 0.6) { //Increase font size
                            quoteEl.style.fontSize = (fontSize + 0.1) + "rem";
                        } else { //Increase line height
                            quoteEl.style.lineHeight = (lineHeight + 0.1) + "rem";
                        }
                    } else {
                        break;
                    }
                }
            }

            function daysBetween(date1, date2) {
                return Math.round(Math.abs((Date.parse(date1) - Date.parse(date2)) / MILLISECONDS_PER_DAY));
            }
        </script>
    </body>
</html>